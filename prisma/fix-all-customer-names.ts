import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

// à¸à¸³à¸«à¸™à¸”à¸Šà¸·à¹ˆà¸­à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸£à¸§à¸¡: OLD_NAMES -> NEW_NAME
const NAME_MAPPINGS: { newName: string; oldNames: string[] }[] = [
    // 1. à¹à¸¡à¹‡à¸à¸à¸¹à¹Šà¸”à¸„à¸²à¸£à¹Œ
    {
        newName: 'à¸šà¸ˆà¸.à¹à¸¡à¹‡à¸à¸à¸¹à¹Šà¸”à¸„à¸²à¸£à¹Œ',
        oldNames: [
            'à¹à¸¡à¹‡à¸à¸à¸¹à¹‰à¸”à¸„à¸²à¸£à¹Œ',
            'à¸š. à¹à¸¡à¹‡à¸à¸à¸¹à¹Šà¸”à¸„à¸²à¸£à¹Œ',
            'à¸š. à¹à¸¡à¹‡à¸à¸‹à¹Œà¸à¸¹à¹‰à¸”à¸„à¸²à¸£à¹Œ',
            'à¸š.à¹à¸¡à¹‡à¸à¸à¸¹à¹‰à¸”à¸„à¸²à¸£à¹Œ',
            'à¸šà¸ˆà¸. à¹à¸¡à¹‡à¸à¸à¸¹à¹‰à¸”à¸„à¸²à¸£à¹Œ',
            'à¸šà¸ˆà¸. à¹à¸¡à¹‡à¸à¸à¸¹à¹Šà¸”à¸„à¸²à¸£à¹Œ',
            'à¸šà¸ˆà¸ .à¹à¸¡à¹‡à¸à¸à¸¹à¹Šà¸”à¸„à¸²à¸£à¹Œ',
        ],
    },
    // 2. à¸™à¹‰à¸³à¸•à¸²à¸¥à¸™à¸„à¸£à¹€à¸žà¸Šà¸£
    {
        newName: 'à¸š.à¸™à¹‰à¸³à¸•à¸²à¸¥à¸™à¸„à¸£à¹€à¸žà¸Šà¸£',
        oldNames: [
            'à¸™à¹‰à¸³à¸•à¸²à¸¥à¸™à¸„à¸£à¹€à¸žà¸Šà¸£',
            'à¸š. à¸™à¹‰à¸³à¸•à¸²à¸¥à¸™à¸„à¸£à¹€à¸žà¸Šà¸£',
            'à¸š.à¸™à¹‰à¸³à¸•à¸²à¸¥à¸™à¸„à¸£à¹€à¸žà¸£à¸Š', // à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”
        ],
    },
    // 3. à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²
    {
        newName: 'à¸šà¸ˆà¸.à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²(à¸¥à¸¹à¸à¸„à¹‰à¸²)',
        oldNames: [
            'à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²(à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸š. à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²(à¸£à¸–à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸š.à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²(à¸£à¸–à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸š.à¸®à¸­à¸™à¸”à¹‰à¸²à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£ (à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸š.à¸®à¸­à¸™à¸”à¹‰à¸²à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£(à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸šà¸ˆà¸. à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸²(à¸¥à¸¹à¸à¸„à¹‰à¸²)',
            'à¸šà¸ˆà¸.à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸®à¸­à¸™à¸”à¹‰à¸² (à¸¥à¸¹à¸à¸„à¹‰à¸²)',
        ],
    },
    // 4. à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸žà¸´à¹€à¸¨à¸©
    {
        newName: 'à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸žà¸´à¹€à¸¨à¸© à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
        oldNames: [
            'à¸¨à¸¸à¸™à¸¢à¹Œà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸žà¸´à¹€à¸¨à¸©', // à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”
            'à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸²à¸£à¸¨à¸¶à¸à¸©à¸²à¸žà¸´à¹€à¸¨à¸©',
            'à¸¨à¸¹à¸™à¸¢à¹Œà¸¨à¸¶à¸à¸©à¸²à¸žà¸´à¹€à¸¨à¸©',
        ],
    },
    // 5. à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´
    {
        newName: 'à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´',
        oldNames: [
            'à¸£.à¸£.à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´',
            'à¸£à¸£. à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´',
            'à¸£à¸£.à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´',
            'à¹‚à¸£à¸‡à¸£à¸µà¸¢à¸™à¹€à¸‰à¸¥à¸´à¸¡à¸žà¸£à¸°à¹€à¸à¸µà¸¢à¸£à¸•à¸´', // à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”
        ],
    },
    // 6. à¸¡à¸±à¸Šà¸Œà¸´à¸¡à¸² à¸”à¸´à¸ªà¸—à¸£à¸´à¸šà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ
    {
        newName: 'à¸šà¸ˆà¸.à¸¡à¸±à¸Šà¸Œà¸´à¸¡à¸² à¸”à¸´à¸ªà¸—à¸£à¸´à¸šà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ',
        oldNames: [
            'à¸šà¸ˆà¸ .à¸¡à¸±à¸Šà¸Œà¸´à¸¡à¸² à¸”à¸´à¸ªà¸—à¸£à¸´à¸šà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ',
            'à¸šà¸ˆà¸. à¸¡à¸±à¸Šà¸Œà¸´à¸¡à¸² à¸”à¸´à¸ªà¸—à¸£à¸´à¸šà¸´à¸§à¹€à¸•à¸­à¸£à¹Œ',
            'à¸šà¸ˆà¸.à¸¡à¸±à¸Šà¸Œà¸´à¸¡à¸²',
        ],
    },
    // 7. à¹€à¸„ à¸žà¸µ à¸­à¸­à¸à¸‹à¸´à¹€à¸ˆà¸™à¸à¸£à¸¸à¹Šà¸›
    {
        newName: 'à¸šà¸ˆà¸.à¹€à¸„ à¸žà¸µ à¸­à¸­à¸à¸‹à¸´à¹€à¸ˆà¸™à¸à¸£à¸¸à¹Šà¸›',
        oldNames: [
            'à¸šà¸ˆà¸ .à¹€à¸„ à¸žà¸µ à¸­à¸­à¸à¸‹à¸´à¹€à¸ˆà¸™à¸à¸£à¸¸à¹Šà¸›',
            'à¸šà¸ˆà¸. à¹€à¸„ à¸žà¸µ à¸­à¸­à¸à¸‹à¸´à¹€à¸ˆà¸™à¸à¸£à¸¸à¹Šà¸›',
            'à¸šà¸ˆà¸. à¹€à¸„à¸žà¸µ à¸­à¸­à¸à¸‹à¸´à¹€à¸ˆà¸™à¸à¸£à¸¸à¹Šà¸›',
            'à¸šà¸ˆà¸. à¹€à¸„à¸žà¸µà¸­à¹Šà¸­à¸à¸‹à¸´à¹€à¸ˆà¸™',
        ],
    },
    // 8. à¸­.à¸­à¸²à¸£à¸¢à¸°à¸§à¸‡à¸¨à¹Œ
    {
        newName: 'à¸šà¸ˆà¸.à¸­.à¸­à¸²à¸£à¸¢à¸°à¸§à¸‡à¸¨à¹Œ',
        oldNames: [
            'à¸­. à¸­à¸²à¸£à¸¢à¸°à¸§à¸‡à¸¨à¹Œ',
            'à¸­.à¸­à¸²à¸£à¸¢à¸°à¸§à¸‡à¸¨à¹Œ',
            'à¸šà¸ˆà¸. à¸­.à¸­à¸²à¸£à¸¢à¸°à¸§à¸‡à¸¨à¹Œ',
        ],
    },
    // 9. à¸—à¸µà¹ˆà¸—à¸³à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡
    {
        newName: 'à¸—à¸µà¹ˆà¸—à¸³à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡(à¸š/à¸Š)',
        oldNames: [
            'à¸—à¸µà¹ˆà¸—à¸³à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡ (à¸š/à¸Š)',
            'à¸—à¸µà¹ˆà¸—à¸³à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡(à¸šà¸±à¸à¸Šà¸µ)',
        ],
    },
    // 10. à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸‡à¹ˆà¸§à¸™à¸®à¸‡à¸«à¸¥à¸µ
    {
        newName: 'à¸«à¸ˆà¸.à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸‡à¹ˆà¸§à¸™à¸®à¸‡à¸«à¸¥à¸µ',
        oldNames: [
            'à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸‡à¹ˆà¸§à¸™à¸®à¸‡à¸«à¸¥à¸µ',
            'à¸«à¸ˆà¸. à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£à¸‡à¹ˆà¸§à¸™à¸®à¸‡à¸«à¸¥à¸µ',
        ],
    },
    // 11. à¸ªà¸¢à¸²à¸¡à¸™à¸´à¸ªà¸ªà¸±à¸™
    {
        newName: 'à¸šà¸ˆà¸.à¸ªà¸¢à¸²à¸¡à¸™à¸´à¸ªà¸ªà¸±à¸™ à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
        oldNames: [
            'à¸ªà¸¢à¸²à¸¡à¸™à¸´à¸ªà¸ªà¸±à¸™',
            'à¸ªà¸¢à¸²à¸¡à¸™à¸´à¸ªà¸ªà¸±à¸™ à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
        ],
    },
    // 12. à¹€à¸­à¹‡à¸¡à¹€à¸­à¹‡à¸¡à¹‚à¸—à¹à¸šà¸„à¹‚à¸„
    {
        newName: 'à¹€à¸­à¹‡à¸¡à¹€à¸­à¹‡à¸¡à¹‚à¸—à¹à¸šà¸„à¹‚à¸„',
        oldNames: [
            'à¹€à¸­à¹‡à¸¡.à¹€à¸­à¹‡à¸¡.à¹‚à¸—à¹à¸šà¸„à¹‚à¸„',
            'à¹€à¸­à¹‡à¸¡à¹€à¸­à¹‡à¸¡ à¹‚à¸—à¹à¸šà¸„à¹‚à¸„',
            'à¹€à¸­à¹‡à¸¡ à¹€à¸­à¹‡à¸¡ à¹‚à¸žà¹à¸šà¸„à¹‚à¸„', // à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”
        ],
    },
    // 13. à¸®à¸±à¹ˆà¸™à¸žà¸‡à¸©à¹Œà¸à¸µà¹ˆ
    {
        newName: 'à¸«à¸ˆà¸.à¸®à¸±à¹ˆà¸™à¸žà¸‡à¸©à¹Œà¸à¸µà¹ˆ (PEPSI)',
        oldNames: [
            'à¸«à¸ˆà¸. à¸®à¸±à¹ˆà¸™à¸žà¸‡à¸©à¹Œà¸à¸µà¹ˆ (PEPSI)',
        ],
    },
    // 14. à¸à¸²à¸£à¹„à¸Ÿà¸Ÿà¹‰à¸²
    {
        newName: 'à¸à¸²à¸£à¹„à¸Ÿà¸Ÿà¹‰à¸²à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
        oldNames: [
            'à¸à¸²à¸£à¹„à¸Ÿà¸Ÿà¹‰à¸² à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
            'à¹„à¸Ÿà¸Ÿà¹‰à¸²à¸à¸³à¹à¸žà¸‡à¹€à¸žà¸Šà¸£',
        ],
    },
    // 15. à¸‰à¸±à¹ˆà¸§à¸à¸²à¸£à¸Šà¹ˆà¸²à¸‡
    {
        newName: 'à¸«à¸ˆà¸.à¸‰à¸±à¹ˆà¸§à¸à¸²à¸£à¸Šà¹ˆà¸²à¸‡',
        oldNames: [
            'à¸‰à¸±à¹ˆà¸§à¸à¸²à¸£à¸Šà¹ˆà¸²à¸‡',
            'à¸«à¸ˆà¸. à¸‰à¸±à¹ˆà¸§à¸à¸²à¸£à¸Šà¹ˆà¸²à¸‡',
        ],
    },
    // 16. à¸—à¸£à¸²à¸¢à¸–à¸²à¸§à¸£
    {
        newName: 'à¸—à¹ˆà¸²à¸—à¸£à¸²à¸¢à¸–à¸²à¸§à¸£',
        oldNames: [
            'à¸—à¸£à¸²à¸¢à¸–à¸²à¸§à¸£',
            'à¸—à¸£à¸²à¸¢à¸–à¸²à¸§à¸£ (à¹‚à¸¥à¸ˆà¸´à¸ªà¸•à¸´à¸à¸ªà¹Œ)',
        ],
    },
    // 17. à¸—à¸µà¹€à¸„à¸‹à¸µ
    {
        newName: 'à¸—à¸µà¹€à¸„à¸‹à¸µà¸£à¸–à¹€à¸à¹ˆà¸²',
        oldNames: [
            'à¸—à¸µà¹€à¸„à¸‹à¸µà¹€à¸à¹ˆà¸²',
        ],
    },
    // 18. à¸¨à¸¸à¸ à¸Šà¸±à¸¢ à¸‡à¸²à¸¡à¸›à¸£à¸°à¹€à¸ªà¸£à¸´à¸ (à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”)
    {
        newName: 'à¸¨à¸¸à¸ à¸Šà¸±à¸¢ à¸‡à¸²à¸¡à¸›à¸£à¸°à¹€à¸ªà¸£à¸´à¸',
        oldNames: [
            'à¸¨à¸¸à¸ à¸Šà¸±à¸š à¸‡à¸²à¸¡à¸›à¸£à¸°à¹€à¸ªà¸£à¸´à¸', // à¸žà¸´à¸¡à¸žà¹Œà¸œà¸´à¸”
        ],
    },
];

async function main() {
    console.log('ðŸ”„ à¸à¸³à¸¥à¸±à¸‡à¸£à¸§à¸¡à¸Šà¸·à¹ˆà¸­à¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸µà¹ˆà¸‹à¹‰à¸³à¸à¸±à¸™...\n');
    console.log('='.repeat(60));

    let totalUpdated = 0;

    for (const mapping of NAME_MAPPINGS) {
        const { newName, oldNames } = mapping;
        let groupUpdated = 0;

        for (const oldName of oldNames) {
            const result = await prisma.transaction.updateMany({
                where: { ownerName: oldName },
                data: { ownerName: newName },
            });

            if (result.count > 0) {
                console.log(`  âœ… "${oldName}" â†’ "${newName}" (${result.count} à¸£à¸²à¸¢à¸à¸²à¸£)`);
                groupUpdated += result.count;
            }
        }

        if (groupUpdated > 0) {
            console.log(`  ðŸ“Š à¸£à¸§à¸¡ ${groupUpdated} à¸£à¸²à¸¢à¸à¸²à¸£\n`);
            totalUpdated += groupUpdated;
        }
    }

    console.log('='.repeat(60));
    console.log(`\nðŸŽ‰ à¸­à¸±à¸›à¹€à¸”à¸•à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” ${totalUpdated} à¸£à¸²à¸¢à¸à¸²à¸£!`);

    // à¹à¸ªà¸”à¸‡à¸ªà¸£à¸¸à¸›à¸Šà¸·à¹ˆà¸­à¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
    console.log('\nðŸ“‹ à¸ªà¸£à¸¸à¸›à¸Šà¸·à¹ˆà¸­à¸¥à¸¹à¸à¸„à¹‰à¸²à¹ƒà¸™à¸£à¸°à¸šà¸š (à¹€à¸£à¸µà¸¢à¸‡à¸•à¸²à¸¡à¸ˆà¸³à¸™à¸§à¸™):');
    const summary = await prisma.transaction.groupBy({
        by: ['ownerName'],
        _count: { ownerName: true },
        orderBy: { _count: { ownerName: 'desc' } },
        take: 30,
    });

    for (const item of summary) {
        if (item.ownerName) {
            console.log(`  - ${item.ownerName}: ${item._count.ownerName} à¸£à¸²à¸¢à¸à¸²à¸£`);
        }
    }
}

main()
    .catch((e) => {
        console.error('âŒ Error:', e);
        process.exit(1);
    })
    .finally(async () => {
        await prisma.$disconnect();
    });
